<!DOCTYPE html> <html lang=en > <meta charset=UTF-8  /> <meta name=viewport  content="width=device-width, initial-scale=1" /> <script async src="https://www.googletagmanager.com/gtag/js?id=G-9YP91K78V2"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-9YP91K78V2'); </script> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css" /> <link rel=stylesheet  href="/css/my_styles.css" /> <link rel=icon  href="/assets/favicon.ico" /> <title>Ising model and the Metropolis algorithm</title> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel=stylesheet  integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin=anonymous  /> <link rel=stylesheet  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" /> <style> @import url("https://fonts.googleapis.com/css2?family=Fira+Code&family=Lexend&family=Lora&family=STIX+Two+Math&family=Work+Sans&family=Major+Mono+Display&family=Space+Mono&family=Libre+Baskerville&family=Averia+Serif+Libre:wght@300&family=Averia+Libre:wght@300&display=swap"); </style> <header class=side-bar > <div class=blog-name > <a href="/" class=expand-on-hover > J<span>aydev</span>SR </a> </div> <nav> <ul id='nav-list'> <li><a href="/">home</a> <li><a href="/blog/">my blog</a> <li><a href="/more/">more</a> </ul> </nav> <div class=copyright > <p>&copy; Jaydev Singh Rao 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl"> <img src="https://franklinjl.org/assets/infra/logoF2.svg" alt=Franklin.jl  srcset="" class=inline-img ></a> and <a href="https://julialang.org"><img src="/assets/images/julialogo.svg" alt="The Julia programming language" srcset="" class=inline-img ></a>.</p> </div> </header> <div class=franklin-content ><h1 id=blogtitle ><a href="#blogtitle" class=header-anchor >Ising model and the Metropolis algorithm</a></h1> <p> <div style="color: slategray; margin-bottom: 10px; font-size: 16px; font-weight: 300;">ðŸ“… 31 December 2021</div> <span style="color: slategray; margin-bottom: 10px; font-size:16px; font-weight: 300;">ðŸ“‹ Using the Metropolis algorithm to simulate the Ising Model by sampling the states from equilibrium.</span> <div class=franklin-toc ><ol><li><a href="#the_ising_model_and_motivation">The Ising Model and Motivation</a><li><a href="#the_markov_chain_monte_carlo_mcmc_methods">The Markov Chain Monte Carlo &#40;MCMC&#41; Methods</a><ol><li><a href="#markov_chains">Markov Chains</a><li><a href="#detailed_balance_and_acceptance_ratios">Detailed Balance and Acceptance Ratios</a></ol><li><a href="#the_metropolis_algorithm_for_the_ising_model">The Metropolis Algorithm for the Ising Model</a><li><a href="#the_appendix">The Appendix</a><ol><li><a href="#code_in_julia">Code &#40;In Julia&#41;</a><li><a href="#some_results">Some Results</a></ol><li><a href="#the_references">The References</a></ol></div></p> <h2 id=the_ising_model_and_motivation ><a href="#the_ising_model_and_motivation" class=header-anchor >The Ising Model and Motivation</a></h2> <p>The Ising model is a very simple model of a <em>magnet</em>. It consists a lattice with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> sites and at each site we have a <strong>spin</strong> &#40;classical&#41;. The spin can take two values either <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >+</span><span class=mord >1</span></span></span></span> &#40;up&#41; or <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >âˆ’</span><span class=mord >1</span></span></span></span> &#40;down&#41;. There can also be an external magnetic field that is applied parallel to the spins.</p> <div class=img-small ><img src="/assets/images/blog/ising_lattice.jpeg" alt="" /></div> <p>Due to interaction of the spins with each other and with the magnetic field we write the total energy &#40;<em>Hamiltonian</em>&#41; of the lattice as:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>H</mi><mo>=</mo><mo>âˆ’</mo><mi>J</mi><munder><mo>âˆ‘</mo><mrow><mo stretchy=false >âŸ¨</mo><mi>i</mi><mi>j</mi><mo stretchy=false >âŸ©</mo></mrow></munder><msub><mi>s</mi><mi>i</mi></msub><msub><mi>s</mi><mi>j</mi></msub><mo>âˆ’</mo><mi>B</mi><munder><mo>âˆ‘</mo><mi>i</mi></munder><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex"> H = -J\sum_{\langle ij \rangle} s_i s_j - B \sum_{i} s_i </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.5660100000000003em;vertical-align:-1.516005em;"></span><span class=mord >âˆ’</span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">âŸ¨</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span><span class="mclose mtight">âŸ©</span></span></span></span><span style="top:-3.0500049999999996em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.516005em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.327674em;vertical-align:-1.277669em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0500050000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.277669em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> <p>Let&#39;s break down the Hamiltonian to see where it comes from:</p> <ul> <li><p>The first term represents the total energy due to the interactions between the neighbouring spins &#40;here <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >âŸ¨</mo><mi>i</mi><mi>j</mi><mo stretchy=false >âŸ©</mo></mrow><annotation encoding="application/x-tex">\langle ij \rangle</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >âŸ¨</span><span class="mord mathnormal" style="margin-right:0.05724em;">ij</span><span class=mclose >âŸ©</span></span></span></span> says that we should sum over nearest neighbours&#41;. In this term, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span> is called the <strong>interaction energy</strong> b.w. nearest neighbours &#40;n.n.&#41;. So if there are only two spins <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">s_1 = +1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >+</span><span class=mord >1</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub><mo>=</mo><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">s_2=-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >âˆ’</span><span class=mord >1</span></span></span></span> then the total interaction energy will be <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span>.</p> <li><p>The second term represents the total energy due to the external magnetic field which is just the sum of the product of <strong>magnetic field energy</strong>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> and the spins <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p> </ul> <p>&nbsp</p> <p>For studying the physics of our system &#40;lattice&#41;, we consider it to be in equilibrium with an external reservior at some temperature <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>. Then from statistical mechanics we have that the probability of the system being in some state <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¼</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Î¼</span></span></span></span> is given by &#40;<em>the Boltzmann distribution</em>&#41;:</p> <a id=boltzmann  class=anchor ></a><span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>p</mi><mi>Î¼</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>Z</mi></mfrac><msup><mi>e</mi><mrow><mo>âˆ’</mo><mi>Î²</mi><msub><mi>H</mi><mi>Î¼</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">p_\mu = \frac1Z e^{-\beta H_\mu}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.716668em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Î¼</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal">e</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mathnormal mtight" style="margin-right:0.05278em;">Î²</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16454285714285716em;"><span style="top:-2.357em;margin-left:-0.08125em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">Î¼</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <p>Where, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î²</mi><mo>=</mo><mstyle displaystyle=true  scriptlevel=0 ><mfrac><mn>1</mn><mrow><mi>k</mi><mi>T</mi></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\beta = \cfrac{1}{kT}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.276em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.5899999999999999em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.74em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span></span></span></span></span></span> with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> being the <em>Boltzmann constant</em> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><mstyle scriptlevel=0  displaystyle=true ><munder><mo>âˆ‘</mo><mi>Î¼</mi></munder><msup><mi>e</mi><mrow><mo>âˆ’</mo><mi>Î²</mi><msub><mi>H</mi><mi>Î¼</mi></msub></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">Z = \displaystyle \sum_{\mu} e^{-\beta H_\mu}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.4361180000000004em;vertical-align:-1.386113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0500050000000003em;"><span style="top:-1.8999949999999999em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Î¼</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.386113em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">e</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mathnormal mtight" style="margin-right:0.05278em;">Î²</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16454285714285716em;"><span style="top:-2.357em;margin-left:-0.08125em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">Î¼</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>. Here, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span> seems like just a &quot;normal&quot; normalization factor but it is of extreme importance&#33; In fact all the thermodynamic quantities for any system can be calculated if we know it&#39;s <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>. So, it is given a special name, <em>the canonical partition function</em> &#40;it won&#39;t be that important for our simulation but in general it is&#41;.</p> <p>Now, let&#39;s say I want to calculate the expectation value of some quantity <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Q</span></span></span></span> &#40;energy, magnetization etc.&#41; then I can do so by:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mo stretchy=false >âŸ¨</mo><mi>Q</mi><mo stretchy=false >âŸ©</mo><mo>=</mo><munder><mo>âˆ‘</mo><mi>Î¼</mi></munder><msub><mi>Q</mi><mi>Î¼</mi></msub><msub><mi>p</mi><mi>Î¼</mi></msub></mrow><annotation encoding="application/x-tex">\langle Q\rangle = \sum_{\mu} Q_\mu p_\mu</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >âŸ¨</span><span class="mord mathnormal">Q</span><span class=mclose >âŸ©</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.4361180000000004em;vertical-align:-1.386113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0500050000000003em;"><span style="top:-1.8999949999999999em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Î¼</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.386113em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">Q</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Î¼</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Î¼</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span> <div class=colbox-blue >Seems easy right? But there is a big issue with this, how do I know the distribution for my given system to begin with? I can&#39;t just go about calculating <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>Î¼</mi></msub></mrow><annotation encoding="application/x-tex">Q_\mu</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">Q</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Î¼</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>Î¼</mi></msub></mrow><annotation encoding="application/x-tex">p_\mu</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.716668em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Î¼</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> for every possible state &#40;even for a lattice of size <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">N=100</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >100</span></span></span></span> there are <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>100</mn></msup></mrow><annotation encoding="application/x-tex">2^{100}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">100</span></span></span></span></span></span></span></span></span></span></span></span> possible states, and there is no need to say that this is a HUGE number of states&#33;&#41;. <strong>This is where the simulation part comes to our rescue</strong>.</div> <h2 id=the_markov_chain_monte_carlo_mcmc_methods ><a href="#the_markov_chain_monte_carlo_mcmc_methods" class=header-anchor >The Markov Chain Monte Carlo &#40;MCMC&#41; Methods</a></h2> <p>In order to determine the expectation values of physical quantities &#40;and other related quantities&#41; we need a representative sample of states that the system goes through at equilibrium. Then using this representative sample we can make an estimate of the desired quantity.</p> <p>The Markov Chain Monte Carlo method is one such method that is used for sampling from a given distribution. To understand how this method works we need to understand what we mean by a Markov chain.</p> <h3 id=markov_chains ><a href="#markov_chains" class=header-anchor >Markov Chains</a></h3> <p>A Markov chain can be thought of as a sequence of random variables <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>0</mn></msub><mo separator=true >,</mo><msub><mi>X</mi><mn>1</mn></msub><mo separator=true >,</mo><mo>â€¦</mo></mrow><annotation encoding="application/x-tex">X_0, X_1, \dots</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >â€¦</span></span></span></span> that take values from some state space <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=script >S</mi></mrow><annotation encoding="application/x-tex">\mathscr{S}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7em;vertical-align:0em;"></span><span class="mord mathscr" style="margin-right:0.19189em;">S</span></span></span></span>. It is then completely specified by the following properties:</p> <ol> <li><p><strong>Initial Distribution</strong>: The probability of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">X_0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> taking some value <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi><mo>âˆˆ</mo><mi mathvariant=script >S</mi></mrow><annotation encoding="application/x-tex">\alpha \in \mathscr{S}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆˆ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.7em;vertical-align:0em;"></span><span class="mord mathscr" style="margin-right:0.19189em;">S</span></span></span></span> i.e. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ï€</mi><mn>0</mn></msub><mo stretchy=false >(</mo><mi>Î±</mi><mo stretchy=false >)</mo><mo>â‰¡</mo><mi mathvariant=double-struck >P</mi><mo stretchy=false >(</mo><msub><mi>X</mi><mn>0</mn></msub><mo>=</mo><mi>Î±</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\pi_0(\alpha)\equiv\mathbb P (X_0 = \alpha)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â‰¡</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">P</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mclose >)</span></span></span></span>.</p> <li><p><strong>Transition Probabilities</strong>: The probability that given some state <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi><mo>âˆˆ</mo><mi mathvariant=script >S</mi></mrow><annotation encoding="application/x-tex">\alpha\in\mathscr S</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆˆ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.7em;vertical-align:0em;"></span><span class="mord mathscr" style="margin-right:0.19189em;">S</span></span></span></span> the next state will be <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î²</mi><mo>âˆˆ</mo><mi mathvariant=script >S</mi></mrow><annotation encoding="application/x-tex">\beta\in\mathscr S</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆˆ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.7em;vertical-align:0em;"></span><span class="mord mathscr" style="margin-right:0.19189em;">S</span></span></span></span> i.e. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo>â†’</mo><mi>Î²</mi><mo stretchy=false >)</mo><mo>â‰¡</mo><mi mathvariant=double-struck >P</mi><mo stretchy=false >(</mo><msub><mi>X</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>Î²</mi><mi mathvariant=normal >âˆ£</mi><msub><mi>X</mi><mi>n</mi></msub><mo>=</mo><mi>Î±</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">T(\alpha\rarr\beta)\equiv \mathbb P(X_{n+1} = \beta | X_n = \alpha)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†’</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â‰¡</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">P</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mord >âˆ£</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mclose >)</span></span></span></span>. These transition probabilities have to be independent of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> for a Markov chain.</p> </ol> <p>In addition to that we have the conditions, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>âˆ‘</mo><mrow><mi>Î±</mi><mo>âˆˆ</mo><mi mathvariant=script >S</mi></mrow></msub><msub><mi>Ï€</mi><mn>0</mn></msub><mo stretchy=false >(</mo><mi>Î±</mi><mo stretchy=false >)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{\alpha\in\mathscr{S}} \pi_0(\alpha) = 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.07708em;vertical-align:-0.32708000000000004em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.19028999999999985em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">Î±</span><span class="mrel mtight">âˆˆ</span><span class="mord mathscr mtight" style="margin-right:0.19189em;">S</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> &#40;the chain has to start in some initial state&#41; and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>âˆ‘</mo><mrow><mi>Î²</mi><mo>âˆˆ</mo><mi mathvariant=script >S</mi></mrow></msub><mi>T</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo>â†’</mo><mi>Î²</mi><mo stretchy=false >)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{\beta\in\mathscr{S}}T(\alpha\rarr\beta) = 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.185818em;vertical-align:-0.43581800000000004em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.19028999999999985em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em;">Î²</span><span class="mrel mtight">âˆˆ</span><span class="mord mathscr mtight" style="margin-right:0.19189em;">S</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†’</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> &#40;the chain either stays in the same state or makes a transition at each step&#41;.</p> <p>&nbsp</p> <div class=colbox-yellow ><p><strong>Let&#39;s take an example to understand this</strong>. Say that a company buys a machine that has 50&#37; chance of being in a working condition &#40;a really bad purchase to be honest&#41;. In addition to that if it is in working condition at some day then there is a 30&#37; percent chance of it being broken the next day. The company also hired a technician who can fix the machine with 70&#37; probability within a day if it is broken. Then this scenario can be modelled as the follownig Markov chain &#40;graphically&#41;:</p> <div class=img-mid ><img src="/assets/images/blog/markov_chain_eg.jpeg" alt="" /></div></div> <hr /> <p>Now, that we have got the basic definitions out of the way, similar to the initial distribution we define:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>Ï€</mi><mi>n</mi></msub><mo stretchy=false >(</mo><mi>Î±</mi><mo stretchy=false >)</mo><mo>=</mo><mi mathvariant=double-struck >P</mi><mo stretchy=false >(</mo><msub><mi>X</mi><mi>n</mi></msub><mo>=</mo><mi>Î±</mi><mo>âˆˆ</mo><mi mathvariant=script >S</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\pi_n(\alpha) = \mathbb P(X_n = \alpha \in \mathscr{S})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">P</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆˆ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathscr" style="margin-right:0.19189em;">S</span><span class=mclose >)</span></span></span></span></span> <p>One of the important question that we need to ask while studying Markov chains is whether the chain converges to some stationary distribution for large <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>. Or in precise terms for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi><mo>âˆˆ</mo><mi mathvariant=script >S</mi></mrow><annotation encoding="application/x-tex">\alpha\in\mathscr{S}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆˆ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.7em;vertical-align:0em;"></span><span class="mord mathscr" style="margin-right:0.19189em;">S</span></span></span></span> is there a fixed distribution <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï€</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span></span></span></span> such that:</p> <a id=stationary_distribution  class=anchor ></a><span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><munder><mrow><mi>lim</mi><mo>â¡</mo></mrow><mrow><mi>n</mi><mo>â†’</mo><mi mathvariant=normal >âˆž</mi></mrow></munder><msub><mi>Ï€</mi><mi>n</mi></msub><mo stretchy=false >(</mo><mi>Î±</mi><mo stretchy=false >)</mo><mo><mover><mo><mo>=</mo></mo><mstyle mathcolor=red ><mo stretchy=false  lspace=0em  rspace=0em >?</mo></mstyle></mover></mo><mi>Ï€</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> \lim_{n\rarr\infty} \pi_n(\alpha) \stackrel{\color{red}{?}}= \pi(\alpha) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.852978em;vertical-align:-0.7em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.69444em;"><span style="top:-2.4em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">â†’</span><span class="mord mtight">âˆž</span></span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >lim</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.7em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel ><span class="mop op-limits"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.152978em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >=</span></span></span><span style="top:-3.5668699999999998em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="color:red;"><span class="mclose mtight" style="color:red;">?</span></span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mclose >)</span></span></span></span></span> <p>&nbsp</p> <div class=colbox-blue ><p>One of the important results from the study of Markov chains is that if the Markov chain satisfies some specific conditions then it must converge to a stationary distribution that is independent of the initial distribution and is only dependent upon the transition probabilities. These conditions are &#40;conditions of <em>ergodicity</em>&#41;:</p> <ol> <li><p><strong>Irreducibility</strong>: Every state is reachable from every other state within finite number of steps.</p> <li><p><strong>Non-periodicity</strong>: After visiting any state it should not be possible to visit the same state with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">nk</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">nk</span></span></span></span> steps for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>1</mn><mo separator=true >,</mo><mn>2</mn><mo separator=true >,</mo><mo>â€¦</mo></mrow><annotation encoding="application/x-tex">n=1,2,\dots</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >2</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >â€¦</span></span></span></span> and fixed integer <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>.</p> </ol> <p>The MCMC algorithms are cleverly designed to have these properties in order to generate states from a fixed distribution. Refer to <span class=bibref >(<a href="#sokal1996">Sokal A. (1997)</a>)</span> for more details.</p> <p><strong>So, the main takeaway is that we can generate any distribution of states we want just by simulating some cleverly designed Markov chains and running them for a long time.</strong></p></div> <h3 id=detailed_balance_and_acceptance_ratios ><a href="#detailed_balance_and_acceptance_ratios" class=header-anchor >Detailed Balance and Acceptance Ratios</a></h3> <p>We say that the Markov chain is in equilibrium when the transitions into any state are just as just as probable as the transitions out of that state. This is when the Markov chain has converged to a stationary distribution. </p> <p>Mathematically for some state <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi><mo>âˆˆ</mo><mi mathvariant=script >S</mi></mrow><annotation encoding="application/x-tex">\alpha\in\mathscr{S}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆˆ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.7em;vertical-align:0em;"></span><span class="mord mathscr" style="margin-right:0.19189em;">S</span></span></span></span> and stationary distribution given by <span class=eqref >(<a href="#stationary_distribution">5</a>)</span>:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><munder><mo>âˆ‘</mo><mrow><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo>âˆˆ</mo><mi mathvariant=script >S</mi></mrow></munder><mi>Ï€</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo stretchy=false >)</mo><mi>T</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo>â†’</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo stretchy=false >)</mo><mo>=</mo><munder><mo>âˆ‘</mo><mrow><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo>âˆˆ</mo><mi mathvariant=script >S</mi></mrow></munder><mi>Ï€</mi><mo stretchy=false >(</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo stretchy=false >)</mo><mi>T</mi><mo stretchy=false >(</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo>â†’</mo><mi>Î±</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> \sum_{\alpha&#x27;\in\mathscr{S}} \pi(\alpha)T(\alpha \rarr \alpha&#x27;) = \sum_{\alpha&#x27;\in\mathscr{S}} \pi(\alpha&#x27;)T(\alpha&#x27; \rarr \alpha) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.38338em;vertical-align:-1.333375em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.050005em;"><span style="top:-1.8439949999999998em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mathscr mtight" style="margin-right:0.19189em;">S</span></span></span></span><span style="top:-3.0500049999999996em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.333375em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mclose >)</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†’</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.051892em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.38338em;vertical-align:-1.333375em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.050005em;"><span style="top:-1.8439949999999998em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mathscr mtight" style="margin-right:0.19189em;">S</span></span></span></span><span style="top:-3.0500049999999996em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.333375em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mclose >)</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†’</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mclose >)</span></span></span></span></span> <p>This condition can be satisfied in many different ways but one such case is if we have:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><menclose notation=box ><mstyle scriptlevel=0  displaystyle=false ><mstyle scriptlevel=0  displaystyle=false ><mstyle scriptlevel=0  displaystyle=true ><mrow><mi>Ï€</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo stretchy=false >)</mo><mi>T</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo>â†’</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo stretchy=false >)</mo><mo>=</mo><mi>Ï€</mi><mo stretchy=false >(</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo stretchy=false >)</mo><mi>T</mi><mo stretchy=false >(</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo>â†’</mo><mi>Î±</mi><mo stretchy=false >)</mo></mrow></mstyle></mstyle></mstyle></menclose><mspace width=1em /><mi mathvariant=normal >âˆ€</mi><mi>Î±</mi><mo separator=true >,</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo>âˆˆ</mo><mi mathvariant=script >S</mi></mrow><annotation encoding="application/x-tex"> \boxed{\pi(\alpha)T(\alpha \rarr \alpha&#x27;) = \pi(\alpha&#x27;)T(\alpha&#x27; \rarr \alpha)} \quad \forall \alpha,\alpha&#x27; \in \mathscr{S} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.7318919999999998em;vertical-align:-0.5899999999999999em;"></span><span class=mord ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.141892em;"><span style="top:-3.7318919999999998em;"><span class=pstrut  style="height:3.7318919999999998em;"></span><span class=boxpad ><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mclose >)</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†’</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mclose >)</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†’</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mclose >)</span></span></span></span></span><span style="top:-3.141892em;"><span class=pstrut  style="height:3.7318919999999998em;"></span><span class="stretchy fbox" style="height:1.7318919999999998em;border-style:solid;border-width:0.04em;"></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.5899999999999999em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:1em;"></span><span class=mord >âˆ€</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆˆ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.7em;vertical-align:0em;"></span><span class="mord mathscr" style="margin-right:0.19189em;">S</span></span></span></span></span> <p>&nbsp</p> <p>The above condition is called the <strong>condition of detailed balance</strong>. So, in our case if we want the stationary &#40;equilibrium&#41; distribution of states to be the Boltzmann distribution <span class=eqref >(<a href="#boltzmann">2</a>)</span> then from detailed balance we need to design the transition probabilities such that:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><mi>T</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo>â†’</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo stretchy=false >)</mo></mrow><mrow><mi>T</mi><mo stretchy=false >(</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo>â†’</mo><mi>Î±</mi><mo stretchy=false >)</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>Ï€</mi><mo stretchy=false >(</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo stretchy=false >)</mo></mrow><mrow><mi>Ï€</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo stretchy=false >)</mo></mrow></mfrac><mo>=</mo><mfrac><msub><mi>p</mi><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup></msub><msub><mi>p</mi><mi>Î±</mi></msub></mfrac><mo>=</mo><mi>exp</mi><mo>â¡</mo><mo stretchy=false >(</mo><mo>âˆ’</mo><mi>Î²</mi><mo stretchy=false >(</mo><msub><mi>H</mi><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup></msub><mo>âˆ’</mo><msub><mi>H</mi><mi>Î±</mi></msub><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> \frac{T(\alpha \rarr \alpha&#x27;)}{T(\alpha&#x27; \rarr \alpha)} = \frac{\pi(\alpha&#x27;)}{\pi(\alpha)} = \frac{p_{\alpha&#x27;}}{p_\alpha} = \exp(-\beta(H_{\alpha&#x27;} - H_{\alpha})) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.364892em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.428892em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6778919999999999em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†’</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†’</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.364892em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.428892em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.988em;vertical-align:-0.8804400000000001em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">Î±</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32797999999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >exp</span><span class=mopen >(</span><span class=mord >âˆ’</span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32797999999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">Î±</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >))</span></span></span></span></span> <p>&nbsp</p> <p>In order to design an algorithm for Markov chain Monte Carlo, we write the transition probability as product of two probabilities:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>T</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo>â†’</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo stretchy=false >)</mo><mo>=</mo><mi>g</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo>â†’</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo stretchy=false >)</mo><mi>A</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo>â†’</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> T(\alpha \rarr \alpha&#x27;) = g(\alpha \rarr \alpha&#x27;)A(\alpha \rarr \alpha&#x27;) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†’</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.051892em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†’</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.051892em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mclose >)</span><span class="mord mathnormal">A</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†’</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.051892em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span></span> <p>Here, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo>â†’</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">g(\alpha \rarr \alpha&#x27;)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†’</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.001892em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> is called the <strong>selection probability</strong> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo>â†’</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">A(\alpha \rarr \alpha&#x27;)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†’</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.001892em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> is called the <strong>acceptance ratio</strong> &#40;of state <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup></mrow><annotation encoding="application/x-tex">\alpha&#x27;</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.751892em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span> from state <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span></span></span></span>&#41;. We are free to choose any values for our selection probabilities and acceptance ratios as long as the condition of detailed balance is satisfied.</p> <p>In the algorithm that we design, a new state <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup></mrow><annotation encoding="application/x-tex">\alpha&#x27;</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.751892em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span> given a current state <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span></span></span></span> is generated with the selection probability and the acceptance ratio determines the fraction of times the new state will be accepted instead of keeping the state current same.</p> <p>&nbsp</p> <div class=colbox-blue ><p>On important note that must be made is that even if we are free to choose any acceptance ratios we want, a good sampling algorithm is always which keeps them as high as possible between <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>. This is because if the acceptance ratios are small then the Markov chain will take a lot of selections to make a few transitions, this means that a lot of computational time is wasted as for getting a good estimate of the desired quantity we want to sample as much states as possible.</p> <p>Due to this, for any two states <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup></mrow><annotation encoding="application/x-tex">\alpha&#x27;</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.751892em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span>, we always fix either <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo>â†’</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">A(\alpha\rarr\alpha&#x27;)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†’</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.001892em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> or <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy=false >(</mo><msup><mi>Î±</mi><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msup><mo>â†’</mo><mi>Î±</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">A(\alpha&#x27;\rarr\alpha)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â†’</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mclose >)</span></span></span></span> to <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> and adjust the other to satisfy the ratio. This ensures that atleast in one direction a move is always accepted and more transitions occur in the algorithm.</p></div> <h2 id=the_metropolis_algorithm_for_the_ising_model ><a href="#the_metropolis_algorithm_for_the_ising_model" class=header-anchor >The Metropolis Algorithm for the Ising Model</a></h2> <p>The Metropolis algorithm for Ising model follows the idea of <strong>sigle spin updates</strong> to generate new states. In this each consecutive state differs from the previous state in orientation of just one spin.</p> <p>The first step in this algorithm &#40;selection&#41; is such that next state is selected at random from uniform distribution of possible states. This means that if there are <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> spins then each spin has a probability of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{N}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.190108em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> for getting selected for flipping.</p> <p>Then in the next step, whether the selected spin will be flipped or not &#40;acceptance&#41; is given the probability of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>f</mi><mi>l</mi><mi>i</mi><mi>p</mi></mrow></msub><mo>=</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><mi>Î²</mi><mi mathvariant=normal >Î”</mi><mi>H</mi></mrow></msup></mrow><annotation encoding="application/x-tex">P_{flip} = e^{-\beta \Delta H}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8491079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">e</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mathnormal mtight" style="margin-right:0.05278em;">Î²</span><span class="mord mtight">Î”</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span></span></span></span></span></span></span></span></span> for positive <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Î”</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">\Delta H</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Î”</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span> and is equal to <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> for negative <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Î”</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">\Delta H</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Î”</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span>. Here, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Î”</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">\Delta H</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Î”</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span> is the change in the total energy after flipping. <em>It can be easily verified that this combination of selection probability and acceptance ratio satisfies detailed balance</em>.</p> <div class=algorithm-box ><div class=title >Metropolis Algorithm</div> <ol> <li><p>Choose a temperature <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> to perform the simulation.</p> <li><p>Select a spin at random from the lattice &#40;uniformly&#41;.</p> <li><p>Calculate the <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Î”</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">\Delta H</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Î”</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span> for spin flip. For selected spin <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span></span></span></span>, it is given by <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Î”</mi><mi>H</mi><mo>=</mo><mn>2</mn><mi>J</mi><msub><mi>s</mi><mtext>old</mtext></msub><mstyle scriptlevel=0  displaystyle=true ><munder><mo>âˆ‘</mo><mtext>sâ€™Â n.n.Â ofÂ s</mtext></munder><msubsup><mi>s</mi><mtext>old</mtext><mo mathvariant=normal  lspace=0em  rspace=0em >â€²</mo></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\Delta H = 2Js_{\text{old}} \displaystyle\sum_{\text{s&#x27; n.n. of s}} s&#x27;_{\text{old}}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Î”</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.3521180000000004em;vertical-align:-1.3021129999999999em;"></span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">old</span></span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0500050000000005em;"><span style="top:-1.847887em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sâ€™Â n.n.Â ofÂ s</span></span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.3021129999999999em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">old</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></p> <li><p>If <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Î”</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">\Delta H</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Î”</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span> is negative then flip the spin. Otherwise for positive <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Î”</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">\Delta H</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Î”</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span>, choose a random number <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> from <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mn>0</mn><mo separator=true >,</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">[0, 1)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >1</span><span class=mclose >)</span></span></span></span> and if <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>&lt;</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><mi>Î²</mi><mi mathvariant=normal >Î”</mi><mi>H</mi></mrow></msup></mrow><annotation encoding="application/x-tex">r &lt; e^{-\beta \Delta H}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8491079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">e</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mathnormal mtight" style="margin-right:0.05278em;">Î²</span><span class="mord mtight">Î”</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span></span></span></span></span></span></span></span></span> then flip the spin.</p> <li><p>Steps <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mn>2</mn><mo stretchy=false >)</mo><mo>âˆ’</mo><mo stretchy=false >(</mo><mn>4</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(2) - (4)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord >2</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord >4</span><span class=mclose >)</span></span></span></span> are followed for several sweeps &#40;one sweep is <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> selection or flip attempts where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> is the total number of spins&#41;. The system is allowed to reach equilibrium first by running for several sweeps and then more sweeps are made for making measurements.</p> </ol></div> <h2 id=the_appendix ><a href="#the_appendix" class=header-anchor >The Appendix</a></h2> <h3 id=code_in_julia ><a href="#code_in_julia" class=header-anchor >Code &#40;In Julia&#41;</a></h3> <ul> <li><p>One sweep of the Metropolis algorithm is performed as:</p> </ul> <pre><code class="julia hljs"><span class=hljs-string >&quot;&quot;&quot;
    ising_metropolis_sweep(spins, T, E, M)
Perform one sweep of the lattice using single-spin-flip dynamics (1 sweep == N*N flip attempts).
Here arguments E and M are the total energy and total magnetization before the sweep.
Returns total energy and magnetization after sweep.
&quot;&quot;&quot;</span>
<span class=hljs-keyword >function</span> ising_metropolis_sweep!(spins, T, E, M)
    N = size(spins)[<span class=hljs-number >1</span>]
    <span class=hljs-keyword >for</span> i = <span class=hljs-number >1</span>:N^<span class=hljs-number >2</span>
        k = rand(<span class=hljs-number >1</span>:N, <span class=hljs-number >2</span>)
        Î”E = deltaE(spins, k, N)
        <span class=hljs-keyword >if</span> accept_flip(Î”E, T)
            spins[k[<span class=hljs-number >1</span>], k[<span class=hljs-number >2</span>]] *= -<span class=hljs-number >1</span>
            E = E + Î”E
            M = M + <span class=hljs-number >2</span>spins[k[<span class=hljs-number >1</span>], k[<span class=hljs-number >2</span>]]
        <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >return</span> E, M
<span class=hljs-keyword >end</span></code></pre> <ul> <li><p>Acceptance ratios for the Metropolis algoritm are given by:</p> </ul> <pre><code class="julia hljs"><span class=hljs-string >&quot;&quot;&quot;
    accept_flip(spins, N, k_i, k_j, T)
Determine whether to accept the next state or not according to Metropolis acceptance rates.
Returns `true` or `false`.
&quot;&quot;&quot;</span>
<span class=hljs-keyword >function</span> accept_flip(Î”E, T)
    <span class=hljs-comment ># Metropolis Acceptance Rates</span>
    <span class=hljs-keyword >if</span> Î”E &lt;= <span class=hljs-number >0</span>
        <span class=hljs-keyword >return</span> <span class=hljs-literal >true</span>
    <span class=hljs-keyword >elseif</span> rand() &lt; exp(-Î”E / T)
        <span class=hljs-keyword >return</span> <span class=hljs-literal >true</span>
    <span class=hljs-keyword >else</span>
        <span class=hljs-keyword >return</span> <span class=hljs-literal >false</span>
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span></code></pre> <ul> <li><p>The difference in energies between states after single flip dynamics can be calculated as:</p> </ul> <pre><code class="julia hljs"><span class=hljs-string >&quot;&quot;&quot;
    delta_E(spins, k)
Calculate the energy difference between two states for one spin flip at site k.
&quot;&quot;&quot;</span>
<span class=hljs-keyword >function</span> deltaE(spins, k, N)
    Î”E = <span class=hljs-number >0</span>
    <span class=hljs-keyword >for</span> Î´ âˆˆ ([<span class=hljs-number >1</span>, <span class=hljs-number >0</span>], [N - <span class=hljs-number >1</span>, <span class=hljs-number >0</span>], [<span class=hljs-number >0</span>, <span class=hljs-number >1</span>], [<span class=hljs-number >0</span>, N - <span class=hljs-number >1</span>])
        nn = k + Î´
        @. nn = mod1(nn, N)  <span class=hljs-comment ># Apply periodic boundary conditions</span>
        Î”E += spins[nn[<span class=hljs-number >1</span>], nn[<span class=hljs-number >2</span>]]
    <span class=hljs-keyword >end</span>
    Î”E *= <span class=hljs-number >2</span>spins[k[<span class=hljs-number >1</span>], k[<span class=hljs-number >2</span>]]
<span class=hljs-keyword >end</span></code></pre> <ul> <li><p>Physical quantities for a given system are calculated as:</p> </ul> <pre><code class="julia hljs"><span class=hljs-string >&quot;&quot;&quot;
    total_magnetization(spins)
Calculate the total magnetization of square spin lattice.
&quot;&quot;&quot;</span>
<span class=hljs-keyword >function</span> total_magnetization(spins)
    <span class=hljs-keyword >return</span> abs(sum(spins))  <span class=hljs-comment ># As B=0</span>
<span class=hljs-keyword >end</span>


<span class=hljs-string >&quot;&quot;&quot;
    total_energy(spins)
Calculate the total energy of the square spin lattice (with zero field and J=1).
&quot;&quot;&quot;</span>
<span class=hljs-keyword >function</span> total_energy(spins)
    N = size(spins)[<span class=hljs-number >1</span>]
    running_sum = <span class=hljs-number >0</span>
    <span class=hljs-keyword >for</span> i = <span class=hljs-number >1</span>:N
        <span class=hljs-keyword >for</span> j = <span class=hljs-number >1</span>:N
            s_k = spins[i, j]
            <span class=hljs-keyword >for</span> Î´ âˆˆ ([<span class=hljs-number >1</span>, <span class=hljs-number >0</span>], [N - <span class=hljs-number >1</span>, <span class=hljs-number >0</span>], [<span class=hljs-number >0</span>, <span class=hljs-number >1</span>], [<span class=hljs-number >0</span>, N - <span class=hljs-number >1</span>])
                nn = [i, j] + Î´
                @. nn = mod1(nn, N)  <span class=hljs-comment ># Apply periodic boundary conditions</span>
                running_sum += s_k * spins[nn[<span class=hljs-number >1</span>], nn[<span class=hljs-number >2</span>]]
            <span class=hljs-keyword >end</span>
        <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >return</span> -running_sum / <span class=hljs-number >2</span>  <span class=hljs-comment ># divide by 2 because each bond counted twice</span>
<span class=hljs-keyword >end</span>


<span class=hljs-string >&quot;&quot;&quot;
    specific_heat(u_vals, T, N)
Calculate the specific heat from given array of internal energy per site (`NÂ²` sites) at temperature `T`.
&quot;&quot;&quot;</span>
<span class=hljs-keyword >function</span> specific_heat(u_vals, T, N)
    <span class=hljs-keyword >return</span> (T^-<span class=hljs-number >2</span>) * N^<span class=hljs-number >2</span> * var(u_vals, corrected = <span class=hljs-literal >false</span>)
<span class=hljs-keyword >end</span>


<span class=hljs-string >&quot;&quot;&quot;
    succeptibility(m_vals, T, N)
Calculate the succeptibility from given array of mean magnetization per site (`NÂ²` sites) at temperature `T`.
&quot;&quot;&quot;</span>
<span class=hljs-keyword >function</span> succeptibility(m_vals, T, N)
    <span class=hljs-keyword >return</span> (T^-<span class=hljs-number >2</span>) * N^<span class=hljs-number >2</span> * var(m_vals, corrected = <span class=hljs-literal >false</span>)
<span class=hljs-keyword >end</span></code></pre> <ul> <li><p>Errors in the results can be calculated using the blocking method:</p> </ul> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Statistics

<span class=hljs-string >&quot;&quot;&quot;
    blocking_err(samples, calc_qty; blocks=10)
Estimate the error in the given samples by blocking method.
Here, `calc_qty` is the function to calculate the quantity in which error has to be calculated.
And, `blocks` is a keyword arguments giving number of blocks.
&quot;&quot;&quot;</span>
<span class=hljs-keyword >function</span> blocking_err(samples, calc_qty, args...; blocks = <span class=hljs-number >20</span>)
    block_array = zeros(<span class=hljs-built_in >Float64</span>, blocks)
    blocklength = length(samples) Ã· blocks
    <span class=hljs-keyword >for</span> i = <span class=hljs-number >1</span>:blocks
        sample_block = samples[(i-<span class=hljs-number >1</span>)*blocklength+<span class=hljs-number >1</span>:i*blocklength]
        block_array[i] = calc_qty(sample_block, args...)
    <span class=hljs-keyword >end</span>
    err = std(block_array)
    <span class=hljs-keyword >return</span> err
<span class=hljs-keyword >end</span></code></pre> <h3 id=some_results ><a href="#some_results" class=header-anchor >Some Results</a></h3> <p>Performing the simulation for a square lattice size of 20 &#40;400 spins&#41;, we get the following results:</p> <ol> <li><p>Magnetization and Succeptibility &#40;per site&#41;:</p> </ol> <p><img src="/assets/images/blog/plots/m_vs_T_20.png" alt="" /></p> <p><img src="/assets/images/blog/plots/x_vs_T_20.png" alt="" /></p> <ol start=2 > <li><p>Internal energy and specific heat &#40;per site&#41; compared with analytical results for an infinite lattice:</p> </ol> <p><img src="/assets/images/blog/plots/u_vs_T_20.png" alt="" /></p> <p><img src="/assets/images/blog/plots/c_vs_T_20.png" alt="" /></p> <div class=colbox-blue >In the above results, we can note a peculiar change in all of the physical quantities at <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>â‰ˆ</mo><mn>2.2</mn></mrow><annotation encoding="application/x-tex">T\approx 2.2 </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >â‰ˆ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2.2</span></span></span></span>. This is an example of a <strong>continuous &#40;second order&#41; phase transition</strong>.</div> <h2 id=the_references ><a href="#the_references" class=header-anchor >The References</a></h2> <ul> <li><p><a id=newman-barkema  class=anchor ></a><strong>Newman, M. E. J., Barkema, G. T. &#40;1999&#41;</strong>. Monte Carlo methods in statistical physics. Oxford: Clarendon Press. <span style="color: slategray;"> (general reference)</span> </p> <li><p><a id=sokal1996  class=anchor ></a><strong>Sokal A. &#40;1997&#41;</strong> Monte Carlo Methods in Statistical Mechanics: Foundations and New Algorithms. In: DeWitt-Morette C., Cartier P., Folacci A. &#40;eds&#41; Functional Integration. NATO ASI Series &#40;Series B: Physics&#41;, vol 361. Springer, Boston, MA. <a href="https://doi.org/10.1007/978-1-4899-0319-8_6">https://doi.org/10.1007/978-1-4899-0319-8_6</a>. <span style="color: slategray;"> (PDF can be found with a google search)</span> </p> <li><p><a id=montecarlogh  class=anchor ></a><strong>Code for simulation</strong>: <a href="https://github.com/JaydevSR/spin-systems-monte-carlo">https://github.com/JaydevSR/spin-systems-monte-carlo</a></p> </ul> <div class=comments-back > <script src="https://utteranc.es/client.js" repo="JaydevSR/personal-website-utterances" issue-term=pathname  theme=github-light  crossorigin=anonymous  async> </script> </div> <div class=page-foot > </div> <div class=scroll-blur ></div></div> <div class=copyright-bottom > <p>&copy; Jaydev Singh Rao 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl"> <img src="https://franklinjl.org/assets/infra/logoF2.svg" alt=Franklin.jl  srcset="" class=inline-img ></a> and <a href="https://julialang.org"><img src="/assets/images/julialogo.svg" alt="The Julia programming language" srcset="" class=inline-img ></a>.</p> </div> <script src="/assets/scripts/myscript.js"></script>